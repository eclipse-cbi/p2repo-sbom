<!DOCTYPE html>
<html lang="en">

<head>
	<title>SBOM | Eclipse Foundation</title>
	<meta name="keywords" content="eclipse,sbom">
	<link rel="icon" type="image/ico" href="favicon.ico">
	<!--
	<link rel="preconnect stylesheet" href="../project.css">
	<script src="../project.js"></script
	<script src="project.js"></script>
	-->
	<style>
		/* <![CDATA[*/
		body {
			font-family: Arial, Helvetica, sans-serif;
			font-size: 10pt;
			margin: 8px;
		}

		main>fieldset {
			margin: 0px;
			padding: 5px;
			white-space: nowrap;
			z-index: 1;
		}

		fieldset img {
			margin-bottom: -0.2em;
		}

		fieldset fieldset {
			margin-top: 0.2em;
			margin-bottom: 0.2em;
			border: 1px solid lightgray;
		}

		img[alt='help'] {
			margin-left: 0.5em;
		}

		.input-section {
			margin: 1em 0em;
		}

		#inputs {
			margin-bottom: 1.2em;
		}

		#filters {
			position: sticky;
			top: 0px;
			background-color: white;
			margin-top: -8px;
		}

		.count {
			color: darkcyan;
			margin-left: .3em;
			font-weight: bold;
			font-size: 85%;
		}

		hr {
			background-color: #eee;
			border: none;
			background-color: darkgray;
			color: black;
			height: 1px;
		}

		code {
			background-color: rgba(0, 0, 0, 0.1);
			border-radius: 0;
			color: #bf637b;
		}

		.action {
			color: #f7941e;
			background-color: inherit;
			font-weight: bolder;
			cursor: pointer;
		}

		.toggle-sample,
		.toggle {
			color: #f7941e;
			background-color: inherit;
			border: none;
			padding: 0px 0px
		}

		.help-nav {
			font-weight: bold;
			font-size: 150%;
			text-align: center;
		}

		#search-error {
			color: crimson;
		}

		.incoming-dependency,
		.outgoing-dependency,
		.purl,
		.license,
		.hash,
		.property,
		.data,
		.reference,
		.ancestor,
		.jar,
		.detail {
			margin-left: 1.5em;
		}

		.jar .label-name,
		.incoming-dependency .label-version,
		.incoming-dependency .label-name,
		.incoming-dependency .label-group,
		.outgoing-dependency .label-version,
		.outgoing-dependency .label-name,
		.outgoing-dependency .label-group {
			opacity: 60%;
		}

		.plain {
			all: unset;
			cursor: pointer;
		}

		.bom-property-key {
			font-weight: bold;
			color: darkblue;
		}

		.bom-property-value {
			color: darkgreen;
		}

		.bom-property-punctuation {
			font-weight: bold;
		}

		.repository {
			display: block;
			color: firebrick;
			padding: .2em 0em;
		}

		.label-version {
			color: darkred;
			font-size: 80%;
		}

		.label-group {
			color: darkcyan;
			font-size: 80%;
		}

		.pedigree-notes b {
			color: firebrick;
			font-size: 120%;
		}

		.pedigree-notes {
			font-size: 80%;
			opacity: 60%;
		}

		.purl-scheme {
			font-size: 50%;
			padding: 0.3em 0.4em;
			color: white;
			background: firebrick;
			vertical-align: middle;
		}

		.purl-group {
			color: darkcyan;
			font-size: 80%;
		}

		.purl-version {
			color: darkred;
		}

		.purl-key {
			font-weight: bold;
			color: darkblue;
			font-size: 66%;
		}

		.purl-value {
			color: darkgreen;
			font-size: 80%;
		}

		.purl-punctuation {
			font-size: 66%;
		}

		.license-id,
		.license-name {
			color: rebeccapurple;
			font-size: 80%;
		}

		.license-url,
		.license-url>a {
			color: firebrick;
			font-size: 90%;
			text-decoration: none;
		}

		.hash span {
			color: darkslateblue;
			background-color: aliceblue;
			padding: 0.01em 0.2em;
			font-size: 75%;
			cursor: copy;
		}

		.property-name {
			font-weight: bold;
			color: darkblue;
			font-size: 80%;
		}

		.property-punctuation {
			font-size: 66%;
		}

		.property-value {
			color: darkgreen;
		}

		.touchpoint {
			display: block;
			color: darkgreen;
			margin-left: 1em;
			white-space: pre;
		}

		.reference-type {
			font-weight: bold;
			color: darkblue;
			font-size: 66%;
		}

		.reference-punctuation {
			font-size: 66%;
		}

		.reference-url,
		.reference-url>a {
			color: firebrick;
			font-size: 90%;
			text-decoration: none;
		}

		.rh {
			font-weight: bold;
			color: rebeccapurple;
		}

		.rqp {
			color: black;
			padding: 0em .1em;
		}

		.rqk {
			color: darkblue;
		}

		.rqv {
			color: darkgreen;
		}

		.detail {
			margin-top: 0.2em;
		}

		.detail>.icon {
			float: left;
			padding-right: 0.2em;
		}

		.detail-description {
			min-width: 20em;
			max-width: 50em;
			display: inline-block;
			color: darkslategray;
			font-family: 'Times New Roman', Times, serif;
			white-space: initial;
		}

		.detail-description>hr {
			margin: 0.2em 0em;
		}

		.icon {
			margin-bottom: -0.2em;
		}

		:target {
			border-style: solid;
			border-width: 1px;
		}

		.loader {
			border: 3px solid #f3f3f3;
			border-top: 3px solid #3498db;
			border-radius: 50%;
			width: .5em;
			height: .5em;
			animation: spin 2s linear infinite;
		}

		#busy-indicaator {
			margin-left: 2em;
		}

		#error-message {
			margin: 1em 0;
			color: firebrick;
		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
			}

			100% {
				transform: rotate(360deg);
			}
		}

		.scrollup {
			background: url(back-to-top.png) no-repeat;
			bottom: 50px;
			display: none;
			height: 40px;
			opacity: .3;
			position: fixed;
			right: 16px;
			text-indent: -9999px;
			width: 40px;
		}

		.modal-popup {
			display: none;
			position: fixed;
			z-index: 1;
			padding-top: 50px;
			padding-bottom: 30px;
			left: 0;
			top: 0;
			width: 100%;
			height: 100vh;
			background-color: rgba(0, 0, 0, 0.7);
		}

		.modal-popup-description {
			display: none;
			overflow: auto;
			margin: auto;
			width: 80%;
			max-width: 900px;
			font-size: 120%;
			color: white;
			padding: 10px 0;
			height: 70vh;
		}

		.modal-popup-description a {
			color: plum;
		}

		.modal-popup-description {
			animation-name: zoom;
			animation-duration: 0.6s;
		}

		@keyframes zoom {
			from {
				transform: scale(0)
			}

			to {
				transform: scale(1)
			}
		}

		.modal-popup-close {
			position: absolute;
			top: 15px;
			right: 35px;
			color: #f1f1f1;
			font-size: 40px;
			font-weight: bold;
			transition: 0.3s;
		}

		.modal-popup-close:hover,
		.modal-popup-close:focus {
			color: #bbb;
			text-decoration: none;
			cursor: pointer;
		}

		@media only screen and (max-width: 900px) {
			modal-content {
				width: 100%;
			}
		}

		/*]]>*/
	</style>
	<script>
		//<![CDATA[

		const reset = '\u27F2';
		const collapsed = '\u25B7';
		const expanded = '\u25E2';

		const showing = '\u25B2';
		const hidden = '\u25BC';

		const purlPattern = /^pkg:(?<scheme>[^/]+)\/((?<group>[^/]+)\/)?(?<name>[^&]+)@(?<version>[^/?]+)(?<query>\?.*|)$/;

		const componentMap = new Map();
		const incomingDependencyMap = new Map();
		const outgoingDependencyMap = new Map();
		const brokenDependencies = new Map();
		const bomProperties = new Map();
		const componentExternalReferenceTypes = new Set();
		const componentPropertyNames = new Set();
		const p2Repositories = new Map();
		const mavenRepositories = new Map();
		const ids = new Map();

		function clear() {
			componentMap.clear();
			incomingDependencyMap.clear();
			outgoingDependencyMap.clear();
			bomProperties.clear();
			componentExternalReferenceTypes.clear();
			componentPropertyNames.clear();
			p2Repositories.clear();
			mavenRepositories.clear();
			ids.clear();
		}

		function restore() {
			const filters = document.getElementById('filters-form');
			filters.reset();
			filter();
		}

		function toElements(text) {
			const wrapper = document.createElement('div');
			wrapper.innerHTML = text;
			return wrapper.children
		}

		function copyToClipboard(text) {
			navigator.clipboard.writeText(text);
		}

		function isFiltered(element) {
			return element.getAttribute('data-filtered') == 'true';
		}

		function setFiltered(element, filtered) {
			element.setAttribute('data-filtered', filtered);
		}

		function isShowing(element) {
			return element.getAttribute('data-showing') == 'true';
		}

		function setShowing(element, filtered) {
			element.setAttribute('data-showing', filtered);
		}

		function generateShowFieldsButton() {
			return `<span class="action" title="Hide/Show Fields" onclick="toggleFields(this)">${showing}</span>`;
		}

		function toggleFields(button) {
			const newState = button.innerText == showing ? hidden : showing;
			button.innerText = newState;
			document.getElementById('filters-form').style.display = button.innerText == showing ? 'block' : 'none';
		}

		function generateSampleButton(value) {
			return `<button class="toggle-sample">${value}</button>`;
		}

		function generateButton(all) {
			return `<button ${all ? 'id="all"' : ''} class="toggle" onclick="${all ? 'toggleAll' : 'toggle'}(this)">${collapsed}</button>`;
		}

		function toggleAll(button) {
			setBusy(true);
			window.setTimeout(() => {
				doToggleAll(button);
				setBusy(false);
			},
				100);
		}

		function doToggleAll(button) {
			const newState = button.innerText == collapsed ? expanded : collapsed;
			if (button.id == 'all') {
				const span = button.parentElement.querySelector('#all + span');
				span.textContent = newState == expanded ? ' Collapse All' : ' Expand All';
			}
			button.innerText = newState;
			for (const b of (button.id == 'all' ? document : button.parentElement).querySelectorAll('button')) {
				if (b != button) {
					setToggleButtonState(b, newState);
				}
			}
		}

		function toggle(button) {
			setToggleButtonState(button, button.innerText == collapsed ? expanded : collapsed);
		}

		function setToggleButtonState(button, state) {
			if (button instanceof Element) {
				let style;
				button.innerText = state;
				if (state == collapsed) {
					style = 'none';
				} else {
					style = 'block';
				}
				for (const div of button.parentElement.querySelectorAll('div')) {
					setShowing(div, style == 'block');
					if (!isFiltered(div)) {
						div.style.display = style;
					}
				}
			}
		}

		function getDependencyElements(dependenciesMap, component, type) {
			const dependencies = dependenciesMap.get(component);
			return dependencyElements = dependencies.map(dep => {
				const bomRef = getModelValue(dep, 'bom-ref');
				const label = getComponentLabel(dep);
				return `<div class="${type}" style="display:none">${getIcon(type + '.svg')} <a class="plain" href="#${bomRef}">${label}</a></div>`;
			});
		}

		function linkify(value) {
			if (value.indexOf('://') < 0) {
				return value;
			}
			try {
				const url = new URL(value);
				return `<a class="plain" href="${value}">${value}</a>`;
			} catch (err) {
				return value;
			}
		}

		function getArtifactURL(scheme, group, name, version, params) {
			if (scheme == 'maven') {
				const repositoryURL = params.get('repository_url') || 'https://repo.maven.apache.org/maven2';
				mavenRepositories.set(repositoryURL, (mavenRepositories.get(repositoryURL) || 0) + 1);
				let url = repositoryURL + '/' + group.replaceAll('.', '/') + '/' + name + '/' + version + '/' + name + '-' + version;
				const classifier = params.get('classifier')
				if (classifier != null) {
					url += '-' + classifier;
				}
				const type = params.get('type')
				url += '.' + (type == null ? 'jar' : type);
				return `<a data-repository-url="${repositoryURL}" href="${url}"><img src="download.svg"></a>`;
			} else if (scheme == 'p2') {
				const repositoryURL = params.get('location');
				p2Repositories.set(repositoryURL, (p2Repositories.get(repositoryURL) || 0) + 1);
				let url = repositoryURL;
				const classifier = params.get('classifier')
				if (classifier == 'osgi.bundle') {
					url += '/plugins/' + name + '_' + version + '.jar';
				} else if (classifier == 'org.eclipse.update.feature') {
					url += '/features/' + name + '_' + version + '.jar';
				} else if (classifier == 'binary') {
					url += '/binary/' + name + '_' + version;
				} else if (classifier == 'metadata') {
				}
				return `<a data-repository-url="${repositoryURL}" href="${url}"><img src="download.svg"></a>`;
			}
			return '';
		}

		function getPurlElement(component) {
			const purl = getModelValue(component, 'purl');
			if (purl != null) {
				const content = getPurlContent(purl);
				if (content != null) {
					return [`
<div class="purl" style="display:none">
${getIcon('purl.svg')}
${content}
 </div>`];
				}
			}
			return [];
		}

		function getPurlContent(purl) {
			const match = purlPattern.exec(purl);
			if (match != null) {
				const scheme = match.groups['scheme'];
				const group = match.groups['group'];
				const name = match.groups['name'];
				const version = match.groups['version'];
				const query = match.groups['query'];
				const searchParams = new URLSearchParams(query == null ? '' : query);
				const params = [];
				params.push(...searchParams.entries().map(([key, value]) =>
					`<span class="purl-key">${key}</span><span class="purl-punctuation">=</span><span class="purl-value">${linkify(value)}</span>`));

				const artifactURL = getArtifactURL(scheme, group, name, version, searchParams);
				return `
<span class="purl-scheme">${scheme}</span>
${group == null ? '' : `<span class="purl-group">${group}</span><span class="purl-punctuation"> / </span>`}
<span class="purl-name">${name}</span>
<span class="purl-punctuation"> @ </span>
<span class="purl-version">${version}</span>
${params.length > 0 ? '<span class="purl-punctuation"> ? </span>' : ''}
${params.join('<span class="purl-punctuation"> &amp; </span>\n')}
${artifactURL}`;
			} else {
				console.log(purl);
				return null;
			}
		}

		function getNestedComponentElements(component) {
			const components = getModelValue(component, 'components');
			if (components != null) {
				return components.map(component => `<div class="jar" style="display:none">
<img class="icon" src="jar.svg">
${getNestedComponentElementDetail(component)}
</div> `);
			}
			return [];
		}

		function getNestedComponentElementDetail(component) {
			const purl = getModelValue(component, 'purl');
			if (purl == null) {
				const name = getModelValue(component, 'name');
				const pedigree = getModelValue(component, 'pedigree');
				const purls = [];
				if (pedigree != null) {
					const notes = getModelValue(pedigree, 'notes');
					const ancestors = getModelValue(pedigree, 'ancestors', []);
					for (const ancestor of ancestors) {
						purls.push(`
${getAncestorElementDetail(ancestor)}
${getFormattedNotes(notes)}
`);
					}
				}
				return `<span class="label-name">${name}</span> ${purls.join(' ')}`;
			}
			// Remove the PURL filter links.
			return getPurlContent(purl).replaceAll(/ data-repository-url="[^"]+"/g, '');
		}

		function getPedigreeElements(component) {
			const pedigree = getModelValue(component, 'pedigree');
			if (pedigree != null) {
				const notes = getModelValue(pedigree, 'notes');
				const ancestors = getModelValue(pedigree, 'ancestors', []);
				return ancestors.map(ancestor => `<div class="ancestor" style="display:none">
<img class="icon" src="ancestor.svg">
${getAncestorElementDetail(ancestor)}
${getFormattedNotes(notes)}
</div> `);
			}
			return [];
		}

		function getFormattedNotes(notes) {
			if (notes == null) {
				return '';
			}
			let processedNotes = notes;
			if (/^((Added |Removed |Modified )[^,]+((, Added |, Removed |, Modified )[^,]+)*)$/.test(notes)) {
				const changes = notes.split(", ");
				const length = changes.length;
				const end = Math.min(12, length);
				const limitedChanges = changes.slice(0, end);
				if (end < length) {
					limitedChanges.push("<b>&hellip;</b>");
				}
				processedNotes = limitedChanges.
					map(change => change.replaceAll('Modified ', '<b>\u0394</b> ').replaceAll('Added ', '<b>+</b> ').replaceAll('Removed ', '<b>\u2212</b> ')).join(', ')
			} else {
				if (notes.length > 200) {
					processedNotes = notes.substring(0, 200) + '&hellip;';
				}
				console.log("!" + notes);
			}
			return `<span class="pedigree-notes" title="${notes}">&nbsp;&nbsp;${processedNotes}<span>`;
		}

		function getAncestorElementDetail(ancestor) {
			const purl = getModelValue(ancestor, 'purl');
			// Remove the PURL filter links.
			return getPurlContent(purl).replaceAll(/ data-repository-url="[^"]+"/g, '');
		}

		function getReferenceElements(component) {
			const references = getModelValue(component, 'externalReferences', []);
			if (references != null) {
				return references.map(reference => `<div class="reference reference-${getClassName(getModelValue(reference, 'type'))}" style="display:none">
					<img class="icon" src="reference.svg">
${getReferenceElementDetail(reference)}
</div > `);
			}
			return [];
		}

		function getReferenceElementDetail(reference) {
			const type = getModelValue(reference, 'type');
			componentExternalReferenceTypes.add(type);
			const url = getModelValue(reference, 'url');
			let actualURL = type == 'vcs' && url != null > 0 ? extraSCMURL(url) : url;
			if (actualURL.startsWith('https://github.com/') && actualURL.indexOf('?') != -1) {
				const gitHubURL = new URL(actualURL);
				const commitId = gitHubURL.searchParams.get('commitId');
				const path = gitHubURL.searchParams.get('path');
				if (path != null && commitId != null) {
					actualURL = `${gitHubURL.origin}${gitHubURL.pathname.replace(/\.git$/, '')}/tree/${commitId}/${path}`;
				}
			}
			return `
<span class="reference-type">${type}</span><span class="reference-punctuation">: </span>
<span class="reference-url"><a href="${actualURL}">${getFormattedHost(getFormattedQuery(url))}</a></span>`;
		}

		function extraSCMURL(url) {
			const result = url.
				replace(/^scm:git:git@([^:]+):/, 'https://$1:/').
				replace(/^scm:git:(git:|ssh:)\/\//, 'https://').
				replace(/^(scm:)?(git:|svn:)?(ssh:)?(git@)?https?:/, 'https:');
			return result;
		}

		function getFormattedQuery(value) {
			if (value.indexOf('?') < 0) {
				return value;
			}
			try {
				const url = new URL(value);
				const searchParams = url.searchParams;
				if (searchParams.size > 0) {
					const formattedQuery = searchParams.entries().map(([key, value]) =>
						`<span class="rqk">${key}</span><span class="rqp">=</span><span class="rqv"">${value}</span>`
					).toArray().join('<span class="rqp">&amp;</span>');
					url.search = '';
					return url + '<span class="rqp">?</span>' + formattedQuery;
				}
				return value;
			} catch (err) {
				return value;
			}
		}

		function getFormattedHost(value) {
			return value.replace(/\/\/([^\/:]+)/, '//<span class="rh">$1</span>');
		}

		function getDetailElements(component) {
			const publisher = getModelValue(component, 'publisher');
			const description = getModelValue(component, 'description');
			if (publisher != null || description != null) {
				const publisherDetail = publisher == null ? '' : `<span class="detail-provider">Provider: ${publisher}</span><hr>`;
				return [`<div class="detail" style="display:none">
<img class="icon" src="detail.svg">
<span class="detail-description">
${publisherDetail}
${description.replace(' - \u200B', '<hr>')}
</span>
</div>`];
			}
			return [];
		}

		function getDataElements(component) {
			const data = getModelValue(component, 'data');
			if (data != null) {
				return data.map(datum => {
					const content = getModelValue(datum, 'contents');
					if (content != null) {
						const attachment = getModelValue(content, 'attachment');
						if (attachment != null) {
							const contentType = getModelValue(attachment, 'contentType');
							if (contentType == 'application/xml') {
								const text = getModelValue(attachment, 'content');
								if (text != null) {
									const escapedValue = text.
										replaceAll('&#x0A;', '\n').
										replaceAll(/^<\/?unit>\n?/gm, '').
										replaceAll('&#x20;', ' ').
										replaceAll('&', '&amp;').
										replaceAll('<', '&lt;').
										replaceAll('>', '&gt;')
									return `<div class="data" style="display:none">
<img class="icon" src="data.svg">
<span class="touchpoint">${escapedValue}</span>
</div>`
								}
							}
						}
					}
					return '';
				});
			}
			return [];
		}

		function getPropertyElements(component) {
			const properties = getModelValue(component, 'properties');
			if (properties != null) {
				return properties.map(property => `<div class="property property-${getClassName(getModelValue(property, 'name'))}" style="display:none">
<img class="icon" src="property.svg">
${getPropertyElementDetail(property)}
</div>`);
			}
			return [];
		}

		function getClassName(value) {
			const result = value.replaceAll(/[.:/!]/g, '-');
			ids.set(result, value);
			return result;
		}

		function getPropertyElementDetail(property) {
			const name = getModelValue(property, 'name');
			componentPropertyNames.add(name);
			const value = getModelValue(property, 'value');
			if (name == 'wrapped-purl') {
				const content = getPurlContent(value);
				if (content != null) {
					return `<span class="property-name">${name}</span><span class="property-punctuation">=</span>${content}`;
				}
			}
			if (name == 'touchpoint') {
				const escapedValue = value.
					replaceAll('&#x0A;', '\n').
					replaceAll(/^<\/?unit>\n?/gm, '').
					replaceAll('&#x20;', ' ').
					replaceAll('&', '&amp;').
					replaceAll('<', '&lt;').
					replaceAll('>', '&gt;')
				return `<span class="property-name">${name}</span><span class="property-punctuation">=</span><span class="property-value touchpoint">${escapedValue}</span>`;
			}
			return `<span class="property-name">${name}</span><span class="property-punctuation">=</span><span class="property-value">${value}</span>`;
		}

		function getHashElements(component) {
			const hashes = getModelValue(component, 'hashes');
			if (hashes != null) {
				const details = hashes.map(hash => {
					const alg = getModelValue(hash, 'alg');
					const content = getModelValue(hash, 'content');
					return `<span title="${content}" onclick="copyToClipboard(this.title)")>${alg}</span>`
				});
				return [`<div class="hash" style="display:none">
<img class="icon" src="hash.svg">
${details.join('\n')}
</div>` ];
			}
			return [];
		}

		function getLicenseElements(component) {
			const licenses = getModelValue(component, 'licenses');
			if (licenses != null) {
				return licenses.map(license => `<div class="license" style="display:none">
<img class="icon" src="license.svg">
${getLicenseElementDetail(license)}
</div>`);
			}
			return [];
		}

		function getLicenseElementDetail(license) {
			const id = getModelValue(license, 'id');
			const name = getModelValue(license, 'name');
			const url = getModelValue(license, 'url');
			let result = '';
			if (id != null) {
				result += `<span class="license-id">${id}</span>`;
			}
			if (name != null) {
				if (result.length > 0) {
					result += ' - ';
				}
				result += `<span class="license-name">${name}</span>`;
			}
			if (url != null) {
				if (result.length > 0) {
					result += ' - ';
				}
				const links = url.split(/[ ,]+/);
				for (const link of links) {
					result += `<span class="license-url"><a href="${url}">${url}</a></span>`;
				}
			}
			return result;
		}

		function getComponentLabel(component) {
			const scope = getModelValue(component, 'scope');
			const group = getModelValue(component, 'group');
			const name = getModelValue(component, 'name');
			const version = getModelValue(component, 'version');
			const groupElement = group == null ? '' : ` - <span class="label-group">${group}</span>`;
			return `<span class="label"><span class="label-name">${name}</span> <span class="label-version">${version}</span>${groupElement}</span>`;
		}


		function getComponentIcon(component) {
			const classifier = getComponentClassifier(component);
			if (classifier == 'binary') {
				return getIcon('binary.svg');
			}
			if (classifier == 'metadata') {
				return getIcon('metadata.svg');
			}
			if (classifier == 'feature') {
				return getIcon('feature.svg');
			}
			if (classifier == 'bundle') {
				return getIcon('bundle.svg');
			}
			const svg = 'library.svg'
			return getIcon(svg);
		}

		function getIcon(svg) {
			return `<img class="icon" src="${svg}" alt="${svg}">`;
		}

		function getComponentClassifier(component) {
			let extClassifier = component.extClassifier
			if (extClassifier == null) {
				const purl = getModelValue(component, 'purl');
				if (purl != null) {
					const searchParams = new URLSearchParams(new URL(purl).searchParams);
					const isMaven = purl.startsWith("pkg:maven/");
					extClassifier = isMaven ? null : searchParams.get('classifier');
					const type = searchParams.get('type');
					if (extClassifier == null && (type == 'jar' || type == null && isMaven)) {
						extClassifier = 'bundle';
					}
				}

				if (extClassifier == null) {
					extClassifier = 'unknown';
				}

				if (extClassifier == 'org.eclipse.update.feature') {
					extClassifier = 'feature';
				}

				if (extClassifier == 'osgi.bundle') {
					extClassifier = 'bundle';
				}

				Object.defineProperty(component, 'extClassifier', {
					value: extClassifier
				})
			}
			return extClassifier;
		}

		function getModelValue(model, property, defaultValue) {
			if (model instanceof Element) {
				if (property == 'bomFormat') {
					return /^https?:\/\/cyclonedx.org\/schema\/bom\/[^\/]+$/.test(model.namespaceURI) ? 'CycloneDX' : model.namespaceURI;
				} else if (property == 'specVersion') {
					return /^.*\/(?<version>[^\/]+)$/.exec(model.namespaceURI).groups.version;
				} else if (property == 'dependsOn') {
					const elements = model.getElementsByTagName('dependency');
					return [...elements].map(element => element.getAttribute('ref'));
				}

				const attributeValue = model.getAttribute(property);
				if (attributeValue != null) {
					return attributeValue;
				}

				const elements = model.querySelectorAll(`:scope > ${property}`);
				if (elements.length == 1) {
					const element = elements.item(0);
					if (property == 'pedigree') {
						return element;
					}

					const children = element.children;
					if (children.length == 0 && !(defaultValue instanceof Array)) {
						return element.textContent;
					}
					return [...children];
				}

				if (model.localName == 'property' && property == 'value' ||
					model.localName == 'hash' && property == 'content') {
					return model.textContent;
				}
			} else {
				const value = model[property];
				if (value != null) {
					return value;
				}

				const license = model['license'];
				if (license != null) {
					return license[property];
				}
			}

			return defaultValue;
		}

		function buildModel(sbom) {
			bomProperties.set('version', getModelValue(sbom, 'version'));
			bomProperties.set('bom-format', getModelValue(sbom, 'bomFormat'));
			bomProperties.set('spec-version', getModelValue(sbom, 'specVersion'));
			bomProperties.set('serial-number', getModelValue(sbom, 'serialNumber'));

			for (const component of getModelValue(sbom, 'components', [])) {
				const bomRef = getModelValue(component, 'bom-ref');
				componentMap.set(bomRef, component);
				outgoingDependencyMap.set(component, []);
			}

			for (const dependency of getModelValue(sbom, 'dependencies', [])) {
				const ref = getModelValue(dependency, 'ref');
				const component = componentMap.get(ref);
				if (component == null) {
					continue;
				}
				const incomingDependencies = getModelValue(dependency, 'dependsOn', []);
				incomingDependencyMap.set(component, [...incomingDependencies].map(ref => {
					const incomingComponent = componentMap.get(ref)
					if (incomingComponent == null) {
						return null;
					}

					outgoingDependencyMap.get(incomingComponent).push(component);
					return incomingComponent;
				}).filter(component => component != null));
			}
		}

		function getQueryParameter(id) {
			const location = new URL(window.location);
			const search = new URLSearchParams(location.search);
			return search.get(id);
		}

		function addMapFunction(value) {
			if (!value.map) {
				Object.getPrototypeOf(value).map = function (mapper) {
					const result = [];
					for (const entry of this) {
						const item = mapper(entry);
						result.push(item);
					}
					return result.values();
				}

				Object.getPrototypeOf(value.map()).toArray = function () {
					const result = [];
					for (const entry of this) {
						result.push(entry);
					}
					return result;
				}
			}
		}

		function hackOlderJavascript() {
			addMapFunction(new Map().entries());
			addMapFunction(new URLSearchParams().entries());
			if (!Object.prototype.hasOwnProperty.call(RegExp, 'escape')) {
				RegExp.escape = function (string) {
					// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#Escaping
					// https://github.com/benjamingr/RegExp.escape/issues/37
					return string.replace(/[.*+\-?^${}()|[\]\\]/g, '\\$&'); // $& means the whole matched string
				};
			}
		}

		function onload() {
			hackOlderJavascript();

			changeInputType();

			const form = document.getElementById('form');
			addEventListener(form);

			const filters = document.getElementById('filters-form');
			filters.reset();
			filters.addEventListener('submit', event => {
				event.preventDefault();
			});

			const search = document.getElementById('search');
			search.addEventListener('keyup', event => {
				if (event.key == 'Enter') {
					filter();
				}
			});

			const file = getQueryParameter('file');
			if (file != null) {
				generateContent(file);
			}

			const copyTargets = document.querySelectorAll('p[data-copy]');
			for (const copyTarget of copyTargets) {
				const copyID = copyTarget.getAttribute('data-copy');
				const element = document.getElementById(copyID);
				copyTarget.append(...element.cloneNode(true).childNodes);
			}

			const generateTargets = document.querySelectorAll('*[data-generate]');
			for (const generateTarget of generateTargets) {
				const value = eval(generateTarget.getAttribute('data-generate'));
				generateTarget.innerHTML = value;
			}

			const helpSections = [...document.querySelectorAll('div[id^="help-"]')];
			for (let i = 0; i < helpSections.length; i++) {
				const helpSection = helpSections[i];
				const currentId = helpSection.id;
				const previousId = i == 0 ? null : helpSections[i - 1].id;
				const nextId = i == helpSections.length - 1 ? null : helpSections[i + 1].id;
				helpSection.append(...toElements(`<div class="help-nav">
${`<span style="opacity: ${previousId == null ? 0.25 : 1.0};" class="action" onclick="helpNav('${currentId}', '${previousId}')" title="Previous">&larr;</span>`}
<span ondblclick="helpNavAll(event)" style="font-size: 50%; vertical-align: middle;">|</span>
${`<span style="opacity: ${nextId == null ? 0.25 : 1.0};" class="action" onclick="helpNav('${currentId}', '${nextId}')" title="Next">&rarr;</span>`}
</div>`));
			}
		}

		var deferedClick;
		var clickCount = 0;
		var doubleClickTimeout = 500;

		function clickOrDoubleClick(handleClick, handleDoubleClick) {
			clickCount++;
			clearTimeout(deferedClick)
			if (clickCount >= 2) {
				setTimeout(() => {
					handleDoubleClick();
				}, 1);
				clickCount = 0;
			} else {
				deferedClick = setTimeout(() => {
					handleClick();
					clickCount = 0;
				}, doubleClickTimeout);
			}
		}

		function filterClick(event, element) {
			event.preventDefault();
			clickOrDoubleClick(() => {
				element.checked = !element.checked;
				filter();
			}, () => {
				element.checked = !element.checked;
				doubleClick(element);
			});
		}

		function doubleClick(element) {
			window.getSelection().empty();
			const elementFilter = element.tagName.toLowerCase() == 'label' ? document.getElementById(element.getAttribute('for')) : element;

			const type = elementFilter.classList.contains('subfilter') ? '.subfilter' : '.filter';

			var allOthersUnchecked = true;
			const filters = element.parentElement.querySelectorAll(type);
			for (const otherFilter of filters) {
				if (otherFilter != element && otherFilter.checked) {
					allOthersUnchecked = false;
					break;
				}
			}

			if (allOthersUnchecked) {
				if (!element.checked) {
					for (const otherFilter of filters) {
						otherFilter.checked = true;
					}
				} else {
					element.checked = true;
				}
			} else {
				for (const otherFilter of filters) {
					if (otherFilter == element) {
						element.checked = true;
					}
					else {
						otherFilter.checked = false;
					}
				}
			}

			filter();
		}

		function changeInputType() {
			const inputTypes = document.querySelectorAll('.input-type');
			for (const inputType of inputTypes) {
				const inputSection = document.getElementById(`${inputType.id}-section`);
				inputSection.style.display = inputType.checked ? 'block' : 'none';
			}
		}

		function setCount(filter, value) {
			const count = filter.nextElementSibling.querySelector('.count');
			if (count != null) {
				count.textContent = value.toLocaleString();
			}
		}

		function filter() {
			setBusy(true);
			window.setTimeout(
				() => {
					doFilter();
					setBusy(false);
				},
				100);
		}

		function doFilter() {
			const filtersFieldset = document.getElementById('filters');
			const filters = filtersFieldset.querySelectorAll('.filter, .subfilter');
			const totals = new Map();
			let show = 'show-all';
			for (const filter of filters) {
				const id = filter.id;
				const checked = filter.checked && !filter.disabled;
				if (id.startsWith('show-')) {
					if (checked) {
						show = id;
					}
					continue;
				}

				if (id == 'property' || id == 'reference' || id == 'purl') {
					const subfilterElements = filter.parentElement.querySelectorAll(`#${id}-filters *`);
					for (const element of subfilterElements) {
						if (element.localName == 'label') {
							element.style.opacity = checked ? '100%' : '50%';
						} else {
							element.disabled = !checked;
						}
					}
					continue;
				}

				let count = 0;
				const elements = id.startsWith('purl-') ? document.querySelectorAll(`a[data-repository-url="${ids.get(id.replace(/^purl-/, ''))}"]`) : document.querySelectorAll('.' + id);
				for (const element of elements) {
					const effectiveElement = element.localName == 'a' ? element.parentElement : element;
					setFiltered(effectiveElement, !checked);
					if (isShowing(effectiveElement)) {
						effectiveElement.style.display = checked ? 'block' : 'none';
					}
					const artifactDiv = effectiveElement.parentElement?.parentElement?.parentElement;
					if (artifactDiv != null && !isFiltered(artifactDiv)) {
						++count;
					}
				}
				totals.set(id, count);
				setCount(filter, count);
			}

			const search = document.getElementById('search');
			const searchError = document.getElementById('search-error');
			searchError.innerText = '';
			let pattern = null;
			try {
				const searchValue = search.value;
				const regexValue = /^\/(.*?)\/?$/.exec(searchValue);
				if (regexValue != null) {
					pattern = new RegExp(regexValue[1]);
				} else {
					pattern = new RegExp(RegExp.escape(searchValue));
				}
			}
			catch (err) {
				const searchError = document.getElementById('search-error');
				searchError.innerText = err.message
				pattern = /.*/;
			}

			let visibleWithChildren = 0;
			let visibleWithoutChildren = 0;
			const toggles = document.querySelectorAll('.toggle');
			for (const toggle of toggles) {
				const parent = toggle.parentElement;
				if (parent.id != 'formatted-target' && toggle.id != 'all') {
					const visibleChildren = toggle.parentElement.querySelectorAll('div[data-filtered=false]');
					const opacity = visibleChildren.length == 0 ? 0 : 1;
					toggle.style.opacity = opacity;

					const label = parent.querySelector('.label-name').textContent;
					const searchMatch = pattern.test(label);

					const hidden = !searchMatch || (show == 'show-with-children' && opacity == 0 || show == 'show-without-children' && opacity == 1);
					if (!isFiltered(parent)) {
						if (searchMatch) {
							if (visibleChildren.length == 0) {
								++visibleWithoutChildren;
							} else {
								++visibleWithChildren;
							}
						}
						setFiltered(parent, !hidden);
						parent.style.display = hidden ? 'none' : 'block';
					}
				}
			}

			for (const [id, value] of new Map(Object.entries({'show-all': visibleWithChildren + visibleWithoutChildren, 'show-with-children': visibleWithChildren, 'show-without-children': visibleWithoutChildren}))) {
				setCount(document.getElementById(id), value);
			}

			const totalElements = document.querySelectorAll('span[data-total');
			for (const totalElement of totalElements) {
				const ids = totalElement.getAttribute('data-total').split(' ');
				let count = 0;
				for (const id of ids) {
					count += totals.get(id);
				}
				totalElement.textContent = count.toLocaleString();
				totalElement.parentElement.style.display = 'inline-block';
			}
		}

		function setBusy(on) {
			document.getElementById('formatted-target').style.display = on ? 'none' : 'block';
			const busyIndicator = document.getElementById('busy-indicator');
			if (busyIndicator != null) {
				const display = on ? 'inline-block' : 'none';
				if (busyIndicator.style.display != display) {
					busyIndicator.style.display = display;
					if (on) {
						if (form.clientHeight != 0) {
							doit();
						}
					}
				}
			}
		}

		function doit() {
			if (form.clientHeight != 0) {
				window.requestAnimationFrame(doit);
			} else {
				setBusy(false);
			}
		};

		function generateContent(file) {
			clear();

			const target = document.getElementById('target');
			const fieldset = document.getElementById('filters');

			document.getElementById('expand-all-section')?.remove();
			fieldset.append(...toElements(`
<div id="expand-all-section" style="font-size: 110%">
	<div id="summary" style="display: none">
	</div>
	<hr>
	${generateShowFieldsButton('all')}
	<span class="action" onclick="restore()" title="Reset Filters">${reset}</span>
	${generateButton('all')}<span> Expand All</span>
	<div id="busy-indicator" style="display: none">
		<div class="loader"></div>
	</div>
	<img onclick="popup(\'help-control\')" alt="help" src="help.svg">
</div>
`));
			setBusy(true);

			try {
				if (file != null) {
					setInputURL(file);
				} else if (document.getElementById('input-file').checked) {
					const fileInput = form['sbom-file'];
					const files = fileInput.files;
					if (files != null && files.length == 1) {
						setInputFile(files[0]);
					} else {
						throw "No file specified";
					}
				} else if (document.getElementById('input-url').checked) {
					const urlInput = form['sbom-url'];
					setInputURL(urlInput.value);
				} else {
					const sbomInput = form['sbom-input'].value.trim();
					setInput(sbomInput);
				}
			} catch (err) {
				handleError(err);
			}
		}

		function handleError(err) {
			setBusy(false);
			const expandAllSection = document.getElementById('expand-all-section');
			expandAllSection?.remove();
			const errorMessage = document.getElementById('error-message');
			if (err instanceof Element) {
				errorMessage.appendChild(err);
			} else {
				errorMessage.innerText = err;
			}
			errorMessage.style.display = 'block';
		}

		function addEventListener(form) {
			form.addEventListener('submit', event => {
				event.preventDefault();
				const errorMessage = document.getElementById('error-message');
				errorMessage.innerText = '';
				generateContent();
			});
		}

		async function setInputURL(url) {
			fetch(url, {cache: "no-cache"}).then(response => {
				try {
					return response.text();
				} catch (err) {
					handleError(err);
				}
			}).then(text => {
				try {
					setInput(text);
				} catch (err) {
					handleError(err);
				}
			}).catch(err => handleError(err));
		}

		async function setInputFile(file) {
			const fileContent = await file.text();
			try {
				setInput(fileContent);
			} catch (err) {
				handleError(err);
			}
		}

		function setInput(sbomInput) {
			if (sbomInput.startsWith('<')) {
				const sbom = new DOMParser().parseFromString(sbomInput, 'text/xml');
				const documentElement = sbom.documentElement;
				const name = documentElement.localName;
				if (name == 'parsererror') {
					throw documentElement;
				} else if (name != 'bom') {
					throw `Expecting a root element named sbom not ${name}`;
				}
				buildModel(sbom.documentElement);
			} else {
				const sbom = JSON.parse(sbomInput);
				buildModel(sbom);
			}

			const components = [...componentMap.values()].filter(component => {
				getComponentClassifier(component);
				return true;
			}).sort((a, b) => {
				const x = getComponentClassifier(a);
				const y = getComponentClassifier(b);
				return x.localeCompare(y) || getModelValue(a, 'name').localeCompare(getModelValue(b, 'name'));
			});

			const componentElements = components.map(component => {
				const purlElements = getPurlElement(component);
				const pedigreeElements = getPedigreeElements(component);
				const nestedComponentElements = getNestedComponentElements(component);
				const licenseElements = getLicenseElements(component);
				const hashElements = getHashElements(component);
				const propertyElements = getPropertyElements(component);
				const referencesElements = getReferenceElements(component);
				// const dataElements = getDataElements(component);
				const dataElements = [];
				const detailElements = getDetailElements(component);
				const incomingDependencyElements = getDependencyElements(incomingDependencyMap, component, 'incoming-dependency');
				const outgoingDependencyElements = getDependencyElements(outgoingDependencyMap, component, 'outgoing-dependency');

				return `<div style="white-space: nowrap;" id=${getModelValue(component, 'bom-ref')} class="${getComponentClassifier(component)}" data-showing="true">
${generateButton()}<span class="label">&nbsp;${getComponentIcon(component)} ${getComponentLabel(component)}<span>
${purlElements.join('\n')}
${pedigreeElements.join('\n')}
${nestedComponentElements.join('\n')}
${licenseElements.join('\n')}
${hashElements.join('\n')}
${propertyElements.join('\n')}
${referencesElements.join('\n')}
${dataElements.join('\n')}
${detailElements.join('\n')}
${incomingDependencyElements.join('\n')}
${outgoingDependencyElements.join('\n')}
</div>`;
			});

			const formattedTarget = document.getElementById('formatted-target');
			formattedTarget.innerHTML = `
${componentElements.join('\n')}
<a class="scrollup" onclick="scrollToTop()">Back to the top</a>
`;


			const summary = document.getElementById('summary');
			const properties = bomProperties.entries().map(([key, value]) =>
				`<span class="bom-property-key">${key}</span><span class="bom-property-punctuation">:</span> <span class="bom-property-value">${value}</span>`
			).toArray();

			summary.innerHTML += properties.join('<span class="bom-property-punctuation">,</span> ') + `
<img onclick="popup(\'help-root\')" alt="help" src="help.svg">
<hr>
<div>
	${generateRepositories(p2Repositories, 'p2')}
	${generateRepositories(mavenRepositories, 'maven')}
</div>
`;
			summary.style.display = 'block';

			const repos = new Set();
			for (const key of p2Repositories.keys()) {
				repos.add(key)
			}
			for (const key of mavenRepositories.keys()) {
				repos.add(key)
			}

			generatNestedFilters(repos, 'purl');
			generatNestedFilters(componentPropertyNames, 'property');
			generatNestedFilters(componentExternalReferenceTypes, 'reference');

			doFilter();

			form.parentElement.style.display = 'none';
		}

		function generateRepositories(repositories, type) {
			const keys = repositories.keys();
			return [...keys].sort().map(url =>
				`<span class="repository"><span class="purl-scheme">${type}</span> <a class="plain" href="${url}">${getFormattedHost(url)}</a> <span class="count">${repositories.get(url)}</span></span>`).join('\n');
		}

		function generatNestedFilters(keys, type) {
			const fieldset = document.getElementById(`${type}-filters`)
			const innerHTML = fieldset.innerHTML
			fieldset.innerHTML =
				[...keys].sort().map(name => `
<input class="subfilter" type="checkbox" id="${type}-${getClassName(name)}" name="${type}-${name}" onclick="filterClick(event, this)" checked>
<label for="${type}-${getClassName(name)}">${name}<span class="count"></span></label>
` ).join(type == 'purl' ? '<br>\n' : '\n') + innerHTML;

			const total = document.querySelector(`label[for=${type}] span[data-total]`);
			total.setAttribute('data-total', [...keys].map(key => `${type}-${getClassName(key)}`).join(' '));
		}

		function scrollToTop() {
			window.scrollTo({top: 0, behavior: 'smooth'});
		}

		function locationHashChanged(event) {
			event.preventDefault();
			const hash = document.location.hash;
			if (hash.length > 1) {
				const element = document.getElementById(hash.substring(1));
				if (element != null) {
					const fieldSet = document.getElementById('filters');
					const height = fieldSet.clientHeight;
					window.scrollBy(0, -height - 2);
				}
			}
		}

		function popup(id) {
			const popup = document.getElementById('popup');
			popup.style.display = 'block';

			const content = document.getElementById(id);
			content.style.display = 'block';

			const closeButton = document.getElementsByClassName('modal-popup-close')[0];

			const escapeListener = event => {
				if (event.key == 'Escape') {
					closeButton.onclick();
				}
			}

			window.document.addEventListener('keyup', escapeListener);

			closeButton.onclick = () => {
				popup.style.display = 'none';
				window.removeEventListener('keyup', escapeListener);
				for (helpSection of document.querySelectorAll('div[id^="help-"]')) {
					helpSection.style.display = 'none';
				}
			}
		}

		function helpNavAll() {
			const popup = document.getElementById('popup');
			popup.style.overflow = 'auto';
			for (helpSection of document.querySelectorAll('div[id^="help-"]')) {
				helpSection.style.display = 'block';
				helpSection.style.overflow = 'inherit';
				helpSection.style.height = 'auto';
			}
		}

		function helpNav(currentId, targetId) {
			const currentContent = document.getElementById(currentId);
			const targetContent = document.getElementById(targetId);
			if (targetContent != null) {
				currentContent.style.display = 'none';
				targetContent.style.display = 'block';
			}
		}

		window.onhashchange = locationHashChanged;

		window.onscroll = function () {
			const footer = document.querySelector(".scrollup");
			if (footer != null) {
				footer.style.display = document.documentElement.scrollTop > 100 ? 'inline' : 'none';
			}
		};

		//]]>
	</script>
</head>

<body onload="onload()">

	<main>
		<fieldset id="inputs">
			<form id="form">
				<input class="input-type" type="radio" id="input-text" name="input" onclick="changeInputType()" checked>
				<label for="input-text">SBOM Text</label>

				<input class="input-type" type="radio" id="input-file" name="input" onclick="changeInputType()">
				<label for="input-file">SBOM File</label>

				<input class="input-type" type="radio" id="input-url" name="input" onclick="changeInputType()">
				<label for="input-url">SBOM URL</label>

				<div class="input-section" id="input-text-section">
					<!--
				<label for="sbom-input">Enter SBOM Text</label><br>
				-->
					<textarea id="sbom-input" name="sbom-input" rows="8" cols="150"></textarea>
				</div>

				<div class="input-section" id="input-file-section">
					<input id="sbom-file" type="file">
				</div>

				<div class="input-section" id="input-url-section">
					<input id="sbom-url" type="url" pattern="https?://.*" size="120">
				</div>

				<div>
					<input type="submit" value="Submit">
				</div>

				<div id="error-message" style="display : none;">
				</div>
			</form>
		</fieldset>

		<fieldset id="filters">
			<form id="filters-form">
				<div>
					<input class="filter" type="checkbox" id="binary" name="binary" onclick="filterClick(event, this)" checked>
					<label for="binary"><img alt="" src="binary.svg"> Binary<span class="count"></span></label>

					<input class="filter" type="checkbox" id="bundle" name="bundle" onclick="filterClick(event, this)" checked>
					<label for="bundle"><img alt="" src="bundle.svg"> Bundle<span class="count"></span></label>

					<input class="filter" type="checkbox" id="feature" name="feature" onclick="filterClick(event, this)" checked>
					<label for="feature"><img alt="" src="feature.svg"> Feature<span class="count"></span></label>

					<input class="filter" type="checkbox" id="metadata" name="metadata" onclick="filterClick(event, this)" checked>
					<label for="metadata"><img alt="" src="metadata.svg"> Metadata<span class="count"></span></label>

					<span style="display: none">&nbsp;&nbsp;&Sigma;<span class="count" data-total='binary bundle feature metadata'></span></span>

					<img onclick="popup('help-unit')" alt="help" src="help.svg">
				</div>

				<br>

				<div>
					<img alt="" src="filter.svg"> <input type="search" placeholder="/.*/" id="search" name="name" size="50">
					<span id="search-error"></span>
					<img onclick="popup('help-name')" alt="help" src="help.svg">
				</div>

				<br>

				<div>
					<input class="filter" type="radio" id="show-all" name="show" onclick="filter()" checked>
					<label for="show-all">All<span class="count"></span></label>

					<input class="filter" type="radio" id="show-with-children" name="show" onclick="filter()">
					<label for="show-with-children">With Children<span class="count"></span></label>

					<input class="filter" type="radio" id="show-without-children" name="show" onclick="filter()">
					<label for="show-without-children">Without Children<span class="count"></span></label>

					<img onclick="popup('help-children')" alt="help" src="help.svg">
					<br>
				</div>

				<hr>

				<div>
					<input class="filter" type="checkbox" id="purl" name="purl" onclick="filterClick(event, this)" checked>
					<label for="purl"><img alt="" src="purl.svg"> PURLs<span class="count" data-total='*'></span></label>
					<img onclick="popup('help-purl')" alt="help" src="help.svg">
					<fieldset class="nested-filters" id="purl-filters">
						<img onclick="popup('help-purl-filter')" alt="help" src="help.svg">
					</fieldset>

					<br>

					<input class="filter" type="checkbox" id="ancestor" name="purl" onclick="filterClick(event, this)" checked>
					<label for="ancestor"><img alt="" src="ancestor.svg"> Pedigree<span class="count"></span></label>
					<img onclick="popup('help-pedigree')" alt="help" src="help.svg">

					<br>

					<input class="filter" type="checkbox" id="jar" name="jar" onclick="filterClick(event, this)" checked>
					<label for="jar"><img alt="" src="jar.svg"> Nested Jars<span class="count"></span></label>
					<img onclick="popup('help-jar')" alt="help" src="help.svg">

					<br>

					<input class="filter" type="checkbox" id="hash" name="hash" onclick="filterClick(event, this)" checked>
					<label for="hash"><img alt="" src="hash.svg"> Hash Sums<span class="count"></span></label>
					<img onclick="popup('help-hashsum')" alt="help" src="help.svg">
					<br>

					<input class="filter" type="checkbox" id="license" name="license" onclick="filterClick(event, this)" checked>
					<label for="license"><img alt="" src="license.svg"> Licenses<span class="count"></span></label>
					<img onclick="popup('help-license')" alt="help" src="help.svg">

					<br>

					<input class="filter" type="checkbox" id="detail" name="detail" onclick="filterClick(event, this)" checked>
					<label for="detail"><img alt="" src="detail.svg"> Details<span class="count"></span></label>
					<img onclick="popup('help-detail')" alt="help" src="help.svg">

					<br>
					<!--
					<input class="filter" type="checkbox" id="data" name="data" onclick="filterClick(event, this)" checked>
					<label for="data"><img alt="" src="data.svg"> Data<span class="count"></span></label>
					<img onclick="popup('help-data')" alt="help" src="help.svg">

					<br>
					-->

					<input class="filter" type="checkbox" id="property" name="property" onclick="filterClick(event, this)" checked>
					<label for="property"><img alt="" src="property.svg"> Properties<span class="count" data-total='*'></span></label>
					<img onclick="popup('help-property')" alt="help" src="help.svg">
					<fieldset class="nested-filters" id="property-filters">
						<img onclick="popup('help-property-filter')" alt="help" src="help.svg">
					</fieldset>

					<input class="filter" type="checkbox" id="reference" name="reference" onclick="filterClick(event, this)" checked>
					<label for="reference"><img alt="" src="reference.svg"> External References<span class="count" data-total='*'></span></label>
					<img onclick="popup('help-external')" alt="help" src="help.svg">
					<fieldset class="nested-filters" id="reference-filters">
						<img onclick="popup('help-external-filter')" alt="help" src="help.svg">
					</fieldset>

					<input class="filter" type="checkbox" id="incoming-dependency" name="incoming-dependency" onclick="filterClick(event, this)" checked>
					<label for="incoming-dependency"><img alt="" src="incoming-dependency.svg"> Incoming Dependencies<span class="count"></span></label>

					<input class="filter" type="checkbox" id="outgoing-dependency" name="outgoing-dependency" onclick="filterClick(event, this)" checked>
					<label for="outgoing-dependency"><img alt="" src="outgoing-dependency.svg"> Outgoing Dependencies<span class="count"></span></label>

					<img onclick="popup('help-dependency')" alt="help" src="help.svg">

				</div>

				<hr>
			</form>
		</fieldset>

		<div id="popup" class="modal-popup">
			<span class="modal-popup-close">&times;</span>
			<div id="help-unit" class="modal-popup-description">
				<div>
					<h3>Unit Category</h3>
					<p>
						The units of a p2 repository or an Eclipse product installation are categorized according to the following classifiers.
					</p>
					<dl>
						<dt><img alt="" src="binary.svg"> Binary</dt>
						<dd>
							A binary unit is a component of type <a href="https://cyclonedx.org/docs/1.6/json/#components_items_type">library</a>.
							It is generally a zip file
							whose content is processed by so-called touchpoints to provision artifacts into an installation.
							For example,
							it can contain a native executable
							that will be assigned the appropriate POSIX permissions when placed at its intended destination.
						</dd>
						<dt><img alt="" src="bundle.svg"> Bundle</dt>
						<dd>
							A bundle unit is a component of type <a href="https://cyclonedx.org/docs/1.6/json/#components_items_type">library</a>.
							It is a jar representing an OSGi bundle.
							The jar may be unpacked when provisioned into an installation.
						</dd>
						<dt><img alt="" src="feature.svg"> Feature</dt>
						<dd>
							A feature unit is a component of type <a href="https://cyclonedx.org/docs/1.6/json/#components_items_type">library</a>.
							It is a jar representing an Eclipse feature,
							which is effectively a collection of dependencies on other bundles and features
							that should be installed together to provide some logically cohesive functionality.
							The jar may be unpacked when provisioned into an installation.
						</dd>
						<dt><img alt="" src="metadata.svg"> Metadata</dt>
						<dd>
							A metadata unit is a component of type <a href="https://cyclonedx.org/docs/1.6/json/#components_items_type">data</a>.
							It is a logical component for which no corresponding physical artifact exists.
							It exists only in a p2 metadata repository or in an installation profile,
							which is also logically a metadata p2 repository.
							It specifies dependencies on other components
							as well as touchpoints describing actions to be applied to artifacts as they are installed.
							For example, it may set program arguments or VM arguments in a product's <code>*.ini</code>.
						</dd>
					</dl>
					<hr>
					<p id="enable-all-disable-all-row">
						Double clicking an item in this section of filters will make it the only check-marked filter
						except if it's already the only check-marked filter,
						in which case all filters will be check-marked.
					</p>
				</div>
			</div>

			<div id="help-name" class="modal-popup-description">
				<h3>Unit Name</h3>
				<p>
					Each component has a <a href="https://cyclonedx.org/docs/1.6/json/#components_items_name">name</a>.
					In terms of p2, this is generally the ID of the unit, which, along with the version, uniquely identifies unit.
				</p>
				<p>
					The content of the view can be filtered to show only the units matching the specified name.
					If the search value starts with a <code>/</code>,
					it will be interpreted as a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_expressions/Cheatsheet">regular expression</a>.
					Otherwise the search value will be interpreted literally.
				</p>
				<p>
					Use the <code>Enter</code> key to apply the filter;
					clear the field to remove the filter.
				</p>
			</div>

			<div id="help-children" class="modal-popup-description">
				<h3>Children</h3>
				<p>
					Details about each component are available as nested content.
					This so-call child content can be displayed via
					the <span data-generate="generateSampleButton(collapsed)"></span> expand
					/ <span data-generate="generateSampleButton(expanded)"></span> collapse
					icon to the left of each component.
					Each type of child content can be individually filtered to reduce the overall information content of the rendered SBOM
					and to provide an overview of just the child content of interest.
				</p>
				<p>
					Via the child filters,
					you can select to show all components,
					only those components with nested children,
					or only those components with no children.
				</p>
				<p>
					You might, for example,
					filter the child content to show only licenses,
					and then elect to show only components with no children
					to get a list of components without licenses.
				</p>
			</div>

			<div id="help-purl" class="modal-popup-description">
				<h3>Package URL</h3>
				<p>
					Each component optionally has a <a href="https://cyclonedx.org/docs/1.6/json/#components_items_purl">PURL</a>, or package-url, that uniquely identifies the component.
					For the CBI SBOM generator, every component has an associated PURL.
					This URL generally encodes traceability details about the origin on the component,
					e.g.,
					the Maven coordinates of an artifact from Maven Central, or
					the originating p2 URL repository along with sufficient details for locating the component that that repository.
				</p>
				<hr>
				<p id="enable-all-disable-all">
					Double clicking this item will make it the only check-marked child filter
					except if it's already the only check-marked child filter,
					in which case all child filters will be check-marked.
				</p>
			</div>

			<div id="help-purl-filter" class="modal-popup-description">
				<h3>PURL URL</h3>
				<p data-copy="enable-all-disable-all-row">
				</p>
			</div>

			<div id="help-pedigree" class="modal-popup-description">
				<h3>Pedigree</h3>
				<p>
					In some cases a component is known to be derived from another component.
					The component from which it is derived is recorded as the <a href="https://cyclonedx.org/docs/1.6/json/#components_items_pedigree">pedigree</a>,
					specifically via the <a href="https://cyclonedx.org/docs/1.6/json/#components_items_pedigree_ancestors">pedigree ancestor</a>.
				</p>
				<p>
					Many artifacts available in Maven Central are not provided in the form of an OSGi bundle,
					i.e., do that have the required OSGi metadata in the <code>MANIFEST.MF</code> that is necessary to function as an OSGi bundle in an OSGi runtime.
					Such an artifact can be repackaged using BND instructions to synthesize the necessary OSGi metadata.
					The Maven Central artifact PURL of the original component is captured to provide traceability.
				</p>
				<p>
					The source artifact associated with each Maven Central binary artifact is also generally not in the form of an OSGi bundle.
					These are automatically transformed by Tycho to add the necessary OSGI metadata to the <code>MANIFEST.MF</code>.
				</p>
				<p>
					In these cases, the Maven Central artifact PURL of the original component is captured in the pedigree to provide traceability details.
					In general, the CBI SBOM generator will compare the checksums of a Maven Central artifact against the checksums of the local artifact
					before generating a PURL reference to the Maven Central artifact.
					When they do not match exactly,
					the pedigree captures the derivation link.
				</p>
				<hr>
				<p data-copy="enable-all-disable-all">
				</p>
			</div>

			<div id="help-jar" class="modal-popup-description">
				<h3>Nested Jars</h3>
				<p>
					In some cases a bundle may embed one or more jars and place them on the
					<a href="https://docs.osgi.org/specification/osgi.core/8.0.0/framework.module.html#framework.module.bundleclasspath">bundle's classpath</a>.
					Such jars are represented as
					<a href="https://cyclonedx.org/docs/1.6/json/#components_items_components">nested components</a>.
				</p>
				<p>
					The CBI SBOM generator will attempt map each such jar to and artifact available on Maven Central.
					The same underlying mechanism as used for predigree tracking of bundles is applied for any jar that can be successfully traced to Maven Central.
				</p>
				<hr>
				<p data-copy="enable-all-disable-all">
				</p>
			</div>

			<div id="help-hashsum" class="modal-popup-description">
				<h3>Hash Sum</h3>
				<p>
					Each component optionally has <a href="https://cyclonedx.org/docs/1.6/json/#components_items_hashes">hashes</a>
					to provide a way to verify that a component's content matches what is expected.
					The CBI aggregator produces hashes for each component that corresponds to a physical artifact,
					i.e., each components of type <a href="https://cyclonedx.org/docs/1.6/json/#components_items_type">library</a>.
					The <a href="https://cyclonedx.org/docs/1.6/json/#components_items_hashes_items_alg">algorithm</a> of the hash is displayed;
					the content can be displayed by hovering and can copied to the clipboard by clicking on algorithm label.
				</p>
				<hr>
				<p data-copy="enable-all-disable-all">
				</p>
			</div>

			<div id="help-license" class="modal-popup-description">
				<h3>License</h3>
				<p>
					Each component optionally has <a href="https://cyclonedx.org/docs/1.6/json/#components_items_licenses">licenses</a>.
					Licences are bit of a mess.
					There are so many different ways and places to specify license details,
					producing consistent, well-formed, accurate license information is a significant challenge for the CBI SBOM generator.
					A license name and license URI are recorded on a best-effort basis.
				</p>
				<hr>
				<p data-copy="enable-all-disable-all">
				</p>
			</div>

			<div id="help-detail" class="modal-popup-description">
				<h3>Detail</h3>
				<p>
					Each component optionally has supplementary details such as
					<a href="https://cyclonedx.org/docs/1.6/json/#components_items_publisher">publisher</a> and
					<a href="https://cyclonedx.org/docs/1.6/json/#components_items_description">description</a>.
					These details are generally available for all bundle and feature components.
				</p>
				<hr>
				<p data-copy="enable-all-disable-all">
				</p>
			</div>

			<div id="help-property" class="modal-popup-description">
				<h3>Property</h3>
				<p>
					Each component optionally has <a href="https://cyclonedx.org/docs/1.6/json/#components_items_properties">properties</a>,
					i.e., a series of name-value pairs that capture additional relevant information.
					In general p2 units have many associated properties,
					most of which are captured in other aspect of the generated SBOM,
					and are therefore generally filtered out by the CBI SBOM generator.
				</p>
				<p>
					The CBI SBOM generator currently attempts to find license information via <a href="https://clearlydefined.io">https://clearlydefined.io</a>
					which generally works well only for artifacts from Maven Central.
					These are recorded in the property <code>clearly-defined</code>.
				</p>
				<p>
					The CBI SBOM generator records touchpoint information as properties.
					Touchpoints are relevant from a security point of view because a touchpoint can in principle configure the installation in a way that affects behaviour of the system,
					possibly in a way that compromises security.
					Of course generally the touchpoints do simple necessary things
					like unzipping an artifact,
					setting POSIX permissions of a resource,
					and setting required program and VM arguments in the product's <code>*.ini</code>.
					These are recorded in the property <code>touchpoint</code>.
				</p>
				<hr>
				<p data-copy="enable-all-disable-all">
				</p>
			</div>

			<div id="help-property-filter" class="modal-popup-description">
				<h3>Property Name</h3>
				<p data-copy="enable-all-disable-all-row">
				</p>
			</div>

			<div id="help-external" class="modal-popup-description">
				<h3>External Reference</h3>
				<p>
					Each component optionally has <a href="https://cyclonedx.org/docs/1.6/json/#components_items_externalReferences">external references</a>,
					i.e., a series of <a href="https://cyclonedx.org/docs/1.6/json/#components_items_externalReferences_items_type">typed</a>
					<a href="https://cyclonedx.org/docs/1.6/json/#components_items_externalReferences_items_url">URLs</a>
					that reference external sites of the given type.
				</p>
				<p>
					The CBI SBOM generator currently attempts to find license information via <a href="https://clearlydefined.io">https://clearlydefined.io</a>
					which generally works well only for artifacts from Maven Central.
					These are recorded in the property <code>clearly-defined</code>.
				</p>
				<p>
					The CBI SBOM generator records touchpoint information as properties.
					Touchpoints are relevant from a security point of view because a touchpoint can in principle configure the installation in a way that affects behaviour of the system,
					possibly in a way that compromises security.
					Of course generally the touchpoints do simple necessary things
					like unzipping an artifact,
					setting POSIX permissions of a resource,
					and setting required program and VM arguments in the product's <code>*.ini</code>.
					These are recorded in the property <code>touchpoint</code>.
				</p>
				<hr>
				<p data-copy="enable-all-disable-all">
				</p>
			</div>

			<div id="help-external-filter" class="modal-popup-description">
				<h3>External Reference Type</h3>
				<p data-copy="enable-all-disable-all-row">
				</p>
			</div>

			<div id="help-dependency" class="modal-popup-description">
				<h3>Dependency: Incoming and Outgoing</h3>
				<p>
					An SBOM supports specifying <a href="https://cyclonedx.org/docs/1.6/json/#dependencies">dependencies</a> between components.
					Directly represented in the SBOM are each
					<a href="https://cyclonedx.org/docs/1.6/json/#dependencies_items_ref">component's</a>
					<a href="https://cyclonedx.org/docs/1.6/json/#dependencies_items_dependsOn">dependencies on other components</a>.
					These are the so-called incoming dependencies.
					The renderer also displays the inverse of this information,
					i.e., the so-called outgoing dependencies.
					These dependencies between components are linkified by the render to support navigation in either direction.
				</p>
				<hr>
				<p data-copy="enable-all-disable-all">
				</p>
			</div>

			<div id="help-root" class="modal-popup-description">
				<h3>SBOM Metadata</h3>
				<p>
					The CBI SBOM generator populates the following information for each SBOM:
				</p>
				<ul>
					<li>
						The <a href="https://cyclonedx.org/docs/1.6/json/#version">version</a> of the SBOM.
					</li>
					<li>
						The <a href="https://cyclonedx.org/docs/1.6/json/#bomFormat">format</a> of the SBOM.
					</li>
					<li>
						The <a href="https://cyclonedx.org/docs/1.6/json/#specVersion">specification version</a> of the SBOM format.
					</li>
					<li>
						The <a href="https://cyclonedx.org/docs/1.6/json/#serialNumber">serial number</a> of the SBOM.
					</li>
				</ul>
			</div>

			<div id="help-control" class="modal-popup-description">
				<h3>Control Area</h3>
				<p>
					The control area provides the following support:
				</p>
				<ul>
					<li>
						The <span data-generate="generateSampleButton(showing)"></span> hide
						/ <span data-generate="generateSampleButton(hidden)"></span> show
						icon allows to hide and show the entire filter and control area above to provide more real estate for the content below.
					</li>
					<li>
						The <span data-generate="generateSampleButton(reset)"></span> reset icon
						allows to reset all filters and controls above to their default values.
					</li>
					<li>
						The <span data-generate="generateSampleButton(collapsed)"></span> Expand All
						/ <span data-generate="generateSampleButton(expanded)"></span> collapse All
						icon allows to expand or collapse all the content below.
					</li>
					<li>
						The <div class="loader" style="display: inline-block"></div> animated busy indicator
						is displayed while the view contents are being computed.
					</li>
				</ul>
			</div>

		</div>

		<pre id="target"></pre>
		<div id="formatted-target"></div>
	</main>

	<script>
	</script>
</body>

</html>